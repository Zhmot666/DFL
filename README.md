# Валидатор JSON-схем

Программа с графическим интерфейсом для работы с JSON-файлами, включая валидацию по схеме, извлечение и обработку данных docagent, а также множество специализированных функций для работы с финансовыми отчетами.

## Функциональность

### Основные функции
- Извлечение JSON-схемы из файлов и сохранение в файл
- Загрузка существующей схемы из файла
- Валидация JSON-файлов по загруженной схеме
- Детальное отображение ошибок валидации с указанием точных строк в файле
- Объединение нескольких JSON-файлов

### Работа с docagent блоками
- Проверка уникальности CLN в docagent блоках
- Создание выборки docagent блоков по списку CLN из текстового файла
- Удаление docagent блоков по CLN (индивидуально или списком)
- Синхронизация блоков tar14 с блоками tar4 по значению nmonth
- Создание отчетов об ошибках, включая сводку по ошибкам в docagent

### Интерфейс
- Удобный графический интерфейс с прогресс-баром
- Разделяемые панели для отображения схемы и результатов
- Подробные отчеты о выполненных операциях
- Возможность сохранения отчетов об ошибках в файл

## Установка

1. Убедитесь, что у вас установлен Python 3.6 или выше
2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Базовые операции
1. Запустите программу:
```bash
python json_schema_validator.py
```

2. Для извлечения и сохранения схемы:
   - Нажмите кнопку "Извлечь схему из JSON"
   - Выберите JSON-файл в диалоговом окне
   - Нажмите кнопку "Сохранить схему в файл" для сохранения

3. Для загрузки существующей схемы:
   - Нажмите кнопку "Загрузить схему из файла"
   - Выберите файл схемы

4. Для валидации JSON-файла:
   - Убедитесь, что схема загружена
   - Нажмите кнопку "Проверить JSON-файл"
   - Выберите JSON-файл для валидации
   - При необходимости выберите "Да", чтобы игнорировать ошибки кратности

### Специализированные функции
5. Для выборки docagent по CLN:
   - Нажмите кнопку "Выборка docagent по CLN"
   - Выберите текстовый файл со списком CLN (по одному CLN на строку)
   - Выберите исходный JSON-файл
   - Укажите место сохранения результата

6. Для удаления docagent по CLN:
   - Нажмите кнопку "Удалить docagent по CLN"
   - Выберите JSON-файл
   - Введите CLN для удаления

7. Для синхронизации tar14 с tar4:
   - Нажмите кнопку "Синхронизировать tar14/tar4"
   - Выберите JSON-файл
   - Программа добавит в блоки tar14 записи, соответствующие nmonth из tar4

8. Для объединения JSON файлов:
   - Нажмите кнопку "Объединить JSON файлы"
   - Выберите файлы для объединения
   - Выберите метод объединения (глубокий или простой)

9. Для сохранения отчета об ошибках:
   - После валидации нажмите "Сохранить отчет об ошибках"
   - Выберите место сохранения файла отчета

## Формат данных

### CLN
Клиентский номер (CLN) представляет собой строку, содержащую цифры и заглавные буквы латинского алфавита, например: `4090773C014PB3`.

### Структура docagent блока
```json
{
  "docagentinfo": {
    "cln": "4090773C014PB3",
    "vfam": "Фамилия",
    "vname": "Имя",
    "votch": "Отчество",
    ...
  },
  "tar4": [...],
  "tar14": [...],
  ...
}
```

### Структура валидного JSON-файла
```json
{
  "pckagent": {
    "pckagentinfo": {...},
    "docagent": [...]
  }
}
```

## Зависимости

- genson==1.2.2 - для генерации JSON-схемы
- jsonschema==4.21.1 - для валидации JSON
- ttkthemes - для улучшенного интерфейса (опционально)

## Примечания

- При работе с большими файлами операции могут занимать продолжительное время, используйте прогресс-бар для отслеживания процесса
- Для корректной работы валидации элемент docagent должен находиться внутри элемента pckagent
- При создании выборки docagent по CLN сохраняется структура исходного файла 